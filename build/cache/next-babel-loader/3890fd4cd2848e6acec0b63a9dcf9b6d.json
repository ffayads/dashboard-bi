{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport Head from 'next/head';\nimport \"../public/assets/css/nucleo-icons.css\";\nimport \"../public/assets/scss/black-dashboard-pro-react.scss?v=1.0.0\";\nimport \"../public/assets/demo/demo.css\";\nimport Router from 'next/router';\nimport Cookies from 'universal-cookie';\nimport { initialState, reducer, ContextOne } from '../context/global';\nimport axios from 'axios';\nimport NProgress from 'nprogress';\naxios.defaults.baseURL = process.env.apiUrl;\naxios.defaults.headers.post['Content-Type'] = 'application/x-www-form-urlencoded';\naxios.defaults.headers.get['Content-Type'] = 'application/x-www-form-urlencoded';\nRouter.events.on('routeChangeStart', function () {\n  NProgress.start();\n});\nRouter.events.on('routeChangeComplete', function () {\n  NProgress.done();\n});\nRouter.events.on('routeChangeError', function () {\n  NProgress.done();\n});\naxios.interceptors.response.use(function (response) {\n  return response;\n}, function (err) {\n  if (Router.route !== \"/login\" && err.response.status === 401 && err.config && !err.config.__isRetryRequest) {\n    cookies.remove(\"Token\");\n    Router.replace(\"/login\");\n    return err;\n  }\n});\nvar cookies = new Cookies();\n\nvar MyApp = function MyApp(_ref) {\n  var Component = _ref.Component,\n      pageProps = _ref.pageProps;\n\n  var _React$useReducer = React.useReducer(reducer, initialState),\n      _React$useReducer2 = _slicedToArray(_React$useReducer, 2),\n      state = _React$useReducer2[0],\n      dispatch = _React$useReducer2[1];\n\n  var value = {\n    state: state,\n    dispatch: dispatch\n  };\n  React.useEffect(function () {\n    validate();\n    return function () {\n      validate();\n    };\n  });\n\n  var validate = function validate() {\n    var auth = cookies.get(\"Token\");\n    axios.defaults.headers.get['Authorization'] = auth;\n    axios.defaults.headers.post['Authorization'] = auth;\n    document.body.classList.add(\"white-content\");\n\n    if (Router.route !== \"/login\" && (auth === undefined || auth === \"\")) {\n      Router.replace(\"/login\");\n    } else if (Router.route === \"/login\" && auth !== \"\" && auth !== undefined) {\n      Router.replace(\"/dashboard\");\n    }\n  };\n\n  React.useEffect(function () {\n    if (state.load) dispatch({\n      type: \"stop-load\"\n    });\n    return function () {\n      Router.events.off('routeChangeStart', function () {\n        NProgress.start();\n      });\n      Router.events.off('routeChangeComplete', function () {\n        NProgress.done();\n      });\n      Router.events.off('routeChangeError', function () {\n        NProgress.done();\n      });\n    };\n  }, []);\n  return __jsx(React.Fragment, null, __jsx(Head, null, __jsx(\"title\", null, \"Via40 Express\"), __jsx(\"meta\", {\n    name: \"viewport\",\n    content: \"initial-scale=1.0, width=device-width\"\n  }), __jsx(\"link\", {\n    rel: \"icon\",\n    href: \"/img/Logo.png\"\n  }), __jsx(\"link\", {\n    rel: \"stylesheet\",\n    type: \"text/css\",\n    href: \"/nprogress.css\"\n  })), __jsx(ContextOne.Provider, {\n    value: value\n  }, __jsx(Component, _extends({}, pageProps, value))));\n};\n\nexport default MyApp;","map":null,"metadata":{},"sourceType":"module"}